<script type="text/javascript">
    var scheduleDate = $("#scheduleDate");
    var frmScheduleAppointment = $("#frmScheduleAppointment");

    $(document).ready(function(){
        scheduleDate.bootstrapMaterialDatePicker({
            format: "YYYY-MM-DD HH:mm",
            time: true
        });

        frmScheduleAppointment.on('submit', function(e){
            e.preventDefault();
            var profile_id = $("#profile_id").val();
            var appointment_datetime = scheduleDate.val();
            var appointment_type = $("#scheduleType").val();

            scheduleAppointment(profile_id, appointment_datetime, appointment_type);
        });
    });

    function scheduleAppointment(profile_id, appointment_datetime, appointment_type){
        var url = "{% url 'api_private_appointment_create' %}?doctor_id={{ doctor.id }}&medical_institution_id={{ medical_institution.id }}";

        var formData = {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            schedule_date: appointment_datetime,
            profile_id: profile_id,
            appointment_type: appointment_type
        };

        $.post(url, formData)
            .done(function(response){
                $.notify({
                    message: response
                }, {
                    type: 'success'
                });

                getQueue(appointment_datetime);
            })
            .fail(function(response){
                $.notify({
                    message: response.responseText
                }, {
                    type: 'danger'
                });
            });
        $("#modalScheduleAppointment").modal('hide');

    }
</script>